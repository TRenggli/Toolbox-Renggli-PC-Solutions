# 🛠️ RENGGLI PC SOLUTIONS - 企业工具箱 V14
## 多平台套件 (Windows | Linux | macOS)

**为IT技术人员提供的专业诊断、修复和管理解决方案**

---

## 🌍 选择您的操作系统

本手册涵盖 **Windows、Linux 和 macOS** 的安装和使用。

**直接跳转到您的部分:**
- 🪟 [Windows 说明](#windows)
- 🐧 [Linux 说明](#linux)
- 🍎 [macOS 说明](#macos)

---

<h1 id="windows">🪟 WINDOWS</h1>

## 📋 系统要求 (Windows)

| 要求 | 规格 |
|------|------|
| **操作系统** | Windows 10/11 (构建版本 1809 或更高) |
| **PowerShell** | 版本 5.1 或更高 (预装) |
| **权限** | 管理员 (必需) |
| **磁盘空间** | 最少 50 MB |
| **网络** | 互联网连接 (用于更新) |

---

## 🚀 Windows 安装 - 分步说明

### 步骤 1: 下载工具

1. 下载完整的 `Herramienta-toolbox` 文件夹
2. 将 ZIP 文件解压到任意位置 (例如: `C:\Tools\`)
3. 您将看到此结构:
   ```
   Herramienta-toolbox/
   ├── Windows/
   │   ├── toolbox.bat
   │   └── toolbox_corporate.bat
   ├── Linux/
   ├── Mac/
   └── Manuales/
   ```

### 步骤 2: 导航到 Windows 文件夹

1. 打开 **文件资源管理器** (Windows + E)
2. 导航到您解压工具的位置
3. 进入 **`Windows`** 文件夹
4. 您将看到以下文件:
   - `toolbox.bat` (完整版本)
   - `toolbox_corporate.bat` (企业版本，不含 MAS)

### 步骤 3: 以管理员身份运行

🔴 **重要**: 必须以管理员权限运行

**方法 1 - 右键单击 (推荐):**

1. **右键单击** `toolbox.bat`
2. 选择 **"以管理员身份运行"**
   ```
   ┌────────────────────────┐
   │ 打开                   │
   │ 编辑                   │
   │ 打印                   │
   │ → 以管理员身份运行      │ ← 此选项
   │ 共享                   │
   └────────────────────────┘
   ```
3. 如果出现 **用户账户控制 (UAC)** 提示，点击 **"是"**

**方法 2 - 从 CMD:**

1. 以管理员身份打开 **CMD**:
   - 按 `Windows + X`
   - 选择 "终端 (管理员)" 或 "命令提示符 (管理员)"
2. 导航到文件夹:
   ```cmd
   cd C:\您解压的路径\Herramienta-toolbox\Windows
   ```
3. 运行:
   ```cmd
   toolbox.bat
   ```

**方法 3 - 从 PowerShell:**

1. 以管理员身份打开 **PowerShell**:
   - 按 `Windows + X`
   - 选择 "Windows PowerShell (管理员)"
2. 导航并运行:
   ```powershell
   cd C:\您解压的路径\Herramienta-toolbox\Windows
   .\toolbox.bat
   ```

### 步骤 4: 选择执行配置文件

运行时，您将看到此屏幕:

```
==============================================================================================================
                        RENGGLI PC SOLUTIONS - SUITE ENTERPRISE V14
==============================================================================================================
当前日志: C:\...\Logs\Audit_2024-02-10.log

[配置文件选择]

1. 诊断       - 只读、审计和查询 (无修改)
2. 修复       - 自动化维护和修复
3. 管理       - 完全访问 (包括格式化和转换)

=> 选择配置文件 [1-3]:
```

**选择您的配置文件:**
- **1** = 仅查看信息，不做更改
- **2** = 允许修复和清理
- **3** = 完全访问 (小心使用)

输入数字并按 **Enter**。

### 步骤 5: 使用主菜单

选择配置文件后，您将看到该配置文件的特定菜单：

#### 🔍 如果您选择了诊断 (配置文件 1):

```
==============================================================================================================
   活动配置文件: [诊断] - 只读

   [ 硬件诊断 ]                    [ 系统信息 ]                    [ 监控 ]
   1. SMART 磁盘状态               4. BIOS 和主板信息              7. 网络速度测试
   2. RAM 测试 (mdsched)           5. 端口/DNS 审计                8. 电池报告
   3. 系统资源信息                 6. Windows 更新状态

   [0] 生成报告并退出              [00] 退出不生成报告
   [99] 更改配置文件
==============================================================================================================

=> 选择一个选项:
```

**此配置文件只有只读选项。** 不修改系统，仅查询信息。

#### 🔧 如果您选择了修复 (配置文件 2):

```
==============================================================================================================
   活动配置文件: [修复] - 维护和修复

   [ 诊断 ]                        [ 系统修复 ]                    [ 网络和更新 ]
   1. SMART 磁盘状态               5. 维护 (DISM/SFC)              9. 网络和 IP 重置
   2. RAM 测试 (mdsched)           6. 修复 Windows Update         10. 速度测试
   3. BIOS 和主板信息              7. EMMC/临时清理               11. 更新应用 (Winget)
   4. 电池报告                     8. 端口/DNS 审计               12. 计划关机

   [0] 生成报告并退出              [00] 退出不生成报告
   [99] 更改配置文件
==============================================================================================================

=> 选择一个选项:
```

**此配置文件包括诊断 + 系统修复。** 可以执行维护但不能执行关键操作。

#### ⚠️ 如果您选择了管理 (配置文件 3):

```
==============================================================================================================
   活动配置文件: [管理] - 完全访问

   [ 硬件诊断 ]                    [ 系统修复 ]                    [ 网络和连接性 ]
   1. SMART 磁盘状态               4. 维护 (DISM/SFC)              7. 网络和 IP 重置
   2. BIOS 和主板信息              5. 修复 Windows Update          8. 真实速度测试
   3. RAM 测试 (mdsched)           6. EMMC/临时清理                9. 端口/DNS 审计

   [ 存储管理 ]                    [ 软件和许可证 ]                [ 自动化 ]
   10. 安全格式化 (已审计)         12. 更新应用 (Winget)          14. 计划关机
   11. MBR 到 GPT 转换             13. 激活 Windows (MAS)         15. 电池报告

   [0] 生成报告并退出              [00] 退出不生成报告
   [99] 更改配置文件
==============================================================================================================

=> 选择一个选项:
```

**此配置文件具有完全访问权限**，包括格式化、GPT 转换和激活等关键操作。

**使用功能:**
1. 输入您想使用的 **选项编号**
2. 按 **Enter**
3. 按照屏幕上的说明操作
4. 工具将逐步引导您

**更改配置文件:**
- 随时输入 **99** 并按 Enter
- 您可以选择不同的配置文件而无需重新启动工具

### 步骤 6: 完成并查看日志

**退出:**
- 输入 **0** 生成 HTML 报告并退出
- 输入 **00** 退出不生成报告 (保存日志 + 校验和)

**关于 HTML 报告:**
- 选项 **0** 会自动在 `Logs/` 文件夹中生成 HTML 文件
- 报告包括所有系统信息和操作日志
- 将自动在浏览器中打开

---

## 📁 日志在哪里？

日志自动保存在:
```
Herramienta-toolbox\Windows\Logs\
├── Audit_2024-02-10.log         (所有操作的记录)
├── Report_2024-02-10.html       (可视化报告)
└── battery-report.html          (如果使用了电池功能)
```

---

## ⚠️ 故障排除 (Windows)

### 错误: "没有管理员权限"
**解决方案:** 必须右键单击 → "以管理员身份运行"

### 错误: "系统无法执行脚本"
**解决方案:**
1. Windows 可能已阻止该文件
2. 右键单击 `toolbox.bat` → 属性
3. 如果看到 "此文件来自另一台计算机"，勾选 "解除阻止"
4. 点击应用 → 确定

### 窗口立即关闭
**解决方案:** 从 CMD 或 PowerShell 运行以查看错误

### 彩色菜单未显示
**解决方案:** 使用 Windows 终端或 CMD (不是 PowerShell ISE)

---

<h1 id="linux">🐧 LINUX</h1>

## 📋 系统要求 (Linux)

| 要求 | 规格 |
|------|------|
| **支持的发行版** | Debian, Ubuntu, Fedora, RHEL, CentOS, Arch, Manjaro, OpenSUSE |
| **Bash** | 版本 4.0 或更高 (预装) |
| **权限** | root 或 sudo (必需) |
| **磁盘空间** | 最少 50 MB |
| **包管理器** | apt, dnf, yum, pacman 或 zypper |

---

## 🚀 Linux 安装 - 分步说明

### 步骤 1: 下载或传输工具

**选项 A - 如果在 Windows 上下载:**
1. 将 `Herramienta-toolbox` 文件夹复制到您的 Linux 系统
2. 使用 USB、共享网络或 FileZilla/SCP

**选项 B - 直接在 Linux 上下载:**
1. 打开终端
2. 下载到您的主文件夹:
   ```bash
   cd ~
   # 在此处下载或解压文件
   ```

### 步骤 2: 导航到 Linux 文件夹

1. 打开 **终端** (大多数发行版上按 Ctrl + Alt + T)
2. 导航到文件夹:
   ```bash
   cd /文件所在路径/Herramienta-toolbox/Linux
   ```

   **示例:**
   ```bash
   cd ~/Downloads/Herramienta-toolbox/Linux
   ```

3. 验证您在正确的位置:
   ```bash
   ls -l
   ```

   您应该看到:
   ```
   toolbox.sh
   toolbox_corporate.sh
   ```

### 步骤 3: 授予执行权限

🔴 **重要**: 脚本需要执行权限

```bash
chmod +x toolbox.sh toolbox_corporate.sh
```

**说明:**
- `chmod +x` = 授予执行权限
- 这只需做一次

### 步骤 4: 用 sudo 运行

🔴 **重要**: 必须以 sudo (作为 root) 运行

**完整版本:**
```bash
sudo ./toolbox.sh
```

**企业版本 (无激活模块):**
```bash
sudo ./toolbox_corporate.sh
```

**每部分的含义:**
- `sudo` = 以超级用户 (root) 运行
- `./` = 从当前文件夹运行
- `toolbox.sh` = 脚本名称

**会要求您输入密码**: 输入并按 Enter
(输入时看不到任何内容，这是正常的安全特性)

### 步骤 5: 选择执行配置文件

您将看到此屏幕:

```
==============================================================================================================
                     RENGGLI PC SOLUTIONS - SUITE ENTERPRISE V14 (LINUX)
==============================================================================================================
当前日志: /路径/Logs/Audit_2024-02-10.log
发行版: ubuntu 22.04 | 包管理器: apt

[配置文件选择]

1. 诊断       - 只读、审计和查询 (无修改)
2. 修复       - 自动化维护和修复
3. 管理       - 完全访问 (包括格式化和关键操作)

=> 选择配置文件 [1-3]:
```

**选择您的配置文件:**
- **1** = 仅诊断，不做更改
- **2** = 允许修复和更新
- **3** = 完全访问 (磁盘格式化、转换)

输入数字并按 **Enter**。

### 步骤 6: 使用主菜单

您将看到包含 **30 个选项** 的菜单，按类别组织:

```
==============================================================================================================
   [ 硬件诊断 ]                 [ 系统修复 ]                 [ 网络和连接性 ]
   1. SMART 磁盘状态            6. 验证系统 (fsck)           11. 网络重置
   2. 完整硬件信息              7. 修复包管理器              12. 速度测试
   3. RAM 内存测试              8. 深度清理                  13. DNS/端口审计
   4. 操作系统信息              9. 修复引导加载程序 (GRUB)  14. 防火墙诊断
   5. 温度和传感器              10. Docker 清理              15. 实时网络监控

   [ 存储管理 ]                 [ 服务和进程 ]               [ 自动化 ]
   16. 安全 USB 格式化          21. 服务管理                 26. 更新系统
   17. MBR 到 GPT 转换          22. CPU/RAM 进程排名         27. 计划关机
   18. 磁盘分析                 23. 查看系统日志             28. 数据备份
   19. 分区挂载                 24. 用户和权限               29. 电池报告
   20. 磁盘空间                 25. 实时监控                 30. 验证完整性

   [0] 生成报告并退出           [00] 退出不生成报告
==============================================================================================================
```

**使用功能:**
1. 输入选项 **编号**
2. 按 **Enter**
3. 按照说明操作
4. 每次操作后按 **Enter** 继续

### 步骤 7: 完成

**退出:**
- 输入 **0** 生成 HTML 报告并退出
- 输入 **00** 退出不生成报告 (保存日志 + 校验和)

**关于 HTML 报告:**
- 选项 **0** 会自动生成 HTML 文件
- 报告包括所有系统信息和操作日志

---

## 📁 日志在哪里？ (Linux)

日志保存在:
```
Herramienta-toolbox/Linux/Logs/
├── Audit_2024-02-10.log           (操作记录)
└── Report_Linux_2024-02-10.html   (可视化报告)
```

查看日志:
```bash
cat Logs/Audit_2024-02-10.log
```

打开 HTML 报告:
```bash
firefox Logs/Report_Linux_2024-02-10.html
# 或您喜欢的浏览器
```

---

## ⚠️ 故障排除 (Linux)

### 错误: "Permission denied"
**解决方案:**
```bash
chmod +x toolbox.sh
sudo ./toolbox.sh
```

### 错误: "No such file or directory"
**解决方案:** 验证您在正确的文件夹中:
```bash
pwd  # 显示当前路径
ls   # 列出文件
```

### 错误: "This script requires root privileges"
**解决方案:** 必须使用 `sudo`:
```bash
sudo ./toolbox.sh
```

### 依赖项未自动安装
**解决方案:** 工具会自动检测并安装包，如:
- smartmontools (用于 SMART)
- lm-sensors (用于温度)
- speedtest-cli (用于速度测试)

如果失败，手动安装:
```bash
# Debian/Ubuntu
sudo apt install smartmontools lm-sensors speedtest-cli

# Fedora/RHEL
sudo dnf install smartmontools lm_sensors speedtest-cli

# Arch
sudo pacman -S smartmontools lm_sensors speedtest-cli
```

---

<h1 id="macos">🍎 macOS</h1>

## 📋 系统要求 (macOS)

| 要求 | 规格 |
|------|------|
| **操作系统** | macOS 10.14 (Mojave) 或更高 |
| **Shell** | Bash 或 Zsh (预装) |
| **权限** | 具有 sudo 的管理员 (必需) |
| **磁盘空间** | 最少 50 MB |
| **Xcode CLI Tools** | 如果缺少则自动安装 |
| **Homebrew** | 推荐 (可自动安装) |

---

## 🚀 macOS 安装 - 分步说明

### 步骤 1: 下载工具

1. 下载 `Herramienta-toolbox` 文件夹
2. 解压文件 (双击 .zip 文件)
3. 将文件夹移动到您喜欢的位置 (例如: `~/Documents/`)

### 步骤 2: 打开终端

**方法 1 - Spotlight:**
1. 按 `Cmd + 空格`
2. 输入 "Terminal"
3. 按 Enter

**方法 2 - Finder:**
1. 打开 **Finder**
2. 转到 **应用程序** → **实用工具**
3. 双击 **终端**

### 步骤 3: 导航到 Mac 文件夹

在终端中，输入:

```bash
cd /文件所在路径/Herramienta-toolbox/Mac
```

**示例:**
```bash
cd ~/Documents/Herramienta-toolbox/Mac
```

**技巧:** 在输入 `cd ` (带空格) 后，可以将文件夹拖到终端中。

验证您在正确的位置:
```bash
ls -l
```

您应该看到:
```
toolbox.sh
toolbox_corporate.sh
```

### 步骤 4: 授予执行权限

```bash
chmod +x toolbox.sh toolbox_corporate.sh
```

### 步骤 5: 允许在安全性中执行 (首次)

🔴 **macOS 重要提示:**

macOS 会阻止从互联网下载的脚本。要允许它们:

**选项 A - 删除隔离:**
```bash
xattr -d com.apple.quarantine toolbox.sh toolbox_corporate.sh
```

**选项 B - 如果出现安全消息:**
1. 尝试运行脚本:
   ```bash
   sudo ./toolbox.sh
   ```
2. 如果 macOS 阻止它，您将看到一条消息
3. 转到 **系统偏好设置** → **安全性与隐私**
4. 在 **通用** 选项卡中，您将看到关于被阻止脚本的消息
5. 点击 **"仍然允许"**
6. 再次运行脚本

### 步骤 6: 用 sudo 运行

🔴 **重要**: 必须以 sudo 运行

**完整版本:**
```bash
sudo ./toolbox.sh
```

**企业版本:**
```bash
sudo ./toolbox_corporate.sh
```

**会要求您输入 macOS 密码**: 输入并按 Enter
(输入时看不到任何内容，这是正常的)

### 步骤 7: 选择配置文件

您将看到此屏幕:

```
==============================================================================================================
                     RENGGLI PC SOLUTIONS - SUITE ENTERPRISE V14 (macOS)
==============================================================================================================
当前日志: /路径/Logs/Audit_2024-02-10.log

[配置文件选择]

1. 诊断       - 只读、审计和查询
2. 修复       - 维护和修复
3. 管理       - 完全访问 (关键操作)

=> 选择配置文件 [1-3]:
```

选择数字并按 Enter。

### 步骤 8: 使用主菜单

菜单与 Linux 类似，有 30 个针对 macOS 优化的选项。

Mac 特定功能包括:
- FileVault 状态 (磁盘加密)
- Gatekeeper 状态 (应用安全)
- SIP 状态 (系统完整性保护)
- Time Machine 备份
- App Store 更新

**退出选项 (macOS):**
- **0** = 退出不生成报告
- **00** = 生成报告并退出
- **01** = 生成报告并返回菜单
- **02** = 退出不保留日志

---

## 📁 日志在哪里？ (macOS)

日志保存在:
```
Herramienta-toolbox/Mac/Logs/
├── Audit_2024-02-10.log
└── Report_Mac_2024-02-10.html
```

查看日志:
```bash
cat Logs/Audit_2024-02-10.log
```

打开 HTML 报告:
```bash
open Logs/Report_Mac_2024-02-10.html
```

---

## ⚠️ 故障排除 (macOS)

### 错误: "Operation not permitted"
**解决方案:** 以 `sudo` 运行:
```bash
sudo ./toolbox.sh
```

### 错误: "command not found: brew"
**解决方案:** 某些功能使用 Homebrew。安装它:
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

### macOS 阻止执行
**解决方案:**
```bash
xattr -d com.apple.quarantine toolbox.sh
```

或转到 **系统偏好设置** → **安全性与隐私** 并允许脚本。

### 未安装 Xcode 命令行工具
**解决方案:** macOS 将自动要求您安装它们。如果没有:
```bash
xcode-select --install
```

---

## 🔒 配置文件系统 (所有系统)

### 1️⃣ 诊断 (只读)
- ✅ 查看硬件信息
- ✅ 状态和查询
- ❌ 不对系统进行更改

**理想用于:**
- 审计
- 预防性检查
- 当您没有授权进行更改时

### 2️⃣ 修复 (维护)
- ✅ 诊断中的所有内容 +
- ✅ 临时文件清理
- ✅ 自动修复
- ✅ 系统更新
- ❌ 不允许格式化或转换

**理想用于:**
- 日常技术支持
- 常规维护
- 解决常见问题

### 3️⃣ 管理 (完全访问)
- ✅ 所有内容 (诊断 + 修复) +
- ✅ 磁盘格式化
- ✅ MBR/GPT 转换
- ✅ 关键操作

⚠️ **注意:** 此配置文件可以删除数据

**理想用于:**
- 高级技术人员
- 新设备准备
- 授权的关键操作

---

## 📊 功能比较

| 功能 | Windows | Linux | macOS |
|------|---------|-------|-------|
| SMART 磁盘状态 | ✅ | ✅ | ✅ |
| 硬件信息 | ✅ | ✅ | ✅ |
| RAM 测试 | ✅ | ✅ | ⚠️ |
| 修复系统 | ✅ DISM/SFC | ✅ fsck | ✅ diskutil |
| 更新 | ✅ Winget | ✅ apt/dnf/pacman | ✅ brew/softwareupdate |
| 网络重置 | ✅ | ✅ | ✅ |
| 速度测试 | ✅ | ✅ | ✅ |
| 磁盘格式化 | ✅ | ✅ | ✅ |
| MBR → GPT | ✅ | ✅ | ❌ |
| Docker | ❌ | ✅ | ✅ |
| 防火墙 | ✅ | ✅ UFW/firewalld | ✅ |
| 电池报告 | ✅ | ✅ | ✅ |

---

## 📞 支持

有问题或疑问？
- 📧 电子邮件: soporte@renggli-solutions.com
- 📚 `Manuales/` 文件夹中的完整文档

---

## 🎯 版本

**工具箱 V14 多平台**
- Windows: 15 个模块
- Linux: 30 个模块
- macOS: 30 个模块

**© 2024 RENGGLI PC SOLUTIONS**
